## Important:

README.md file in this folder is autogenerated doc when `fastlane` command is run.
Please DO NOT install FastLane as described in there, rather see no. 2 in next section!

##One time setup for FastLane, iOS

1. This assumes you are running with a macOS machine, and you have Xcode 9.2+ installed
2. In project root folder `sudo bundle update`. This will install FastLane and CocoaPods using Gemfile and Gemfile.lock
3. You need to install dev. and app store certificates and profiles.
4. Go to folder `fastlane/ios_signing_files`.
Now drag the files with extension `.mobileprovision` over opened Xcode icon in Dock. This will install the profiles.
5. In the same folder double click to install `.p12` files, with password `SocialX2018`. 
The certificates along with private keys will get into `Keychain` app. 

## Build and distribute for both platforms at in one step

1. In project root folder run `bundle exec fastlane release version:1.0.9`. 
The last parameter is the new version we want to create and should be in [Semver](https://semver.org/#summary)  format.
The preconditions to build are: 
- current branch starts with `beta/`
- local branch is clean, with no local changes

2. After build: you can commit the changes with the new version, on the beta branch.

## Building and distribution for iOS via TestFlight

1. In project root folder run `bundle exec fastlane ios release version:1.0.9`. 
For TestFlight you will need the AppStore connect password for account `christian@socialx.network`.
The password can also be supplied by setting ENV variable FASTLANE_PASSWORD.
The last parameter is the new version we want to create and should be in [Semver](https://semver.org/#summary) format.
The preconditions to build are: 
- current branch starts with `beta/`
- local branch is clean, with no local changes

2. Build process has 5 steps (lanes), as can be seen in `fastlane/fast.rb`
- install_dev lane: will do a clean install for project dependencies using yarn + pod
- version lane: will creat a new version, update package.json and platform specific files, both iOS and Android
- ios_build lane: will do the actual build and sign the iOS IPA file
- send_testflight lane: this will upload the IPA file to TestFlight for app with ID: `socialxnetwork`
- ios_bugsnag lane: this will execute script `./ios-bugsnag.sh` that uploads sourcemaps and minified JS file 
to BugSnag for error reporting.

3. After build: you can commit the changes with the new version, on the beta branch.

## Building and distribution for Android via Google play beta

1. In project root folder run `bundle exec fastlane android release version:1.0.9`.
The last parameter is the new version we want to create and should be in [Semver](https://semver.org/#summary)  format.
The preconditions to build are: 
- current branch starts with `beta/`
- local branch is clean, with no local changes

2. Build process has 6 steps (lanes), as can be seen in `fastlane/fast.rb`, under platform :android lane :release 

3. After build: you can commit the changes with the new version, on the beta branch.